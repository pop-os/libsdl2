From: Simon McVittie <smcv@debian.org>
Date: Wed, 11 Aug 2021 14:51:46 +0100
Subject: Revert "Fixed XSync sequence to match other cases where we set the
 X11 error handler"

This reverts commit b033cd0d2e02c8616e26471ce218aee356e927c3.

Bug: https://github.com/libsdl-org/SDL/issues/4630
Forwarded: https://github.com/libsdl-org/SDL/pull/4631
---
 src/video/x11/SDL_x11modes.c | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

diff --git a/src/video/x11/SDL_x11modes.c b/src/video/x11/SDL_x11modes.c
index 8a9cf56..0ac47b3 100644
--- a/src/video/x11/SDL_x11modes.c
+++ b/src/video/x11/SDL_x11modes.c
@@ -1057,10 +1057,9 @@ X11_SetDisplayMode(_THIS, SDL_VideoDisplay * sdl_display, SDL_DisplayMode * mode
            for now we cheat and just catch the X11 error and carry on, which
            is likely to cause subtle issues but is better than outright
            crashing */
-        X11_XSync(display, False);
         PreXRRSetScreenSizeErrorHandler = X11_XSetErrorHandler(SDL_XRRSetScreenSizeErrHandler);
         X11_XRRSetScreenSize(display, RootWindow(display, data->screen), mode->w, mode->h, mm_width, mm_height);
-        X11_XSync(display, False);
+        X11_XSync(display, False);  /* hopefully force any protocol errors to process with this handler. */
         X11_XSetErrorHandler(PreXRRSetScreenSizeErrorHandler);
 
         status = X11_XRRSetCrtcConfig (display, res, output_info->crtc, CurrentTime,
